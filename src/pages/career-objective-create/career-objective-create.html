<ion-header>
    <ion-navbar>
        <ion-title>{{ 'GLOBAL.DEVELOPMENT_PROGRAM' | translate }}</ion-title>
    </ion-navbar>
</ion-header>

<ion-content padding>
    <h1 *ngIf="isCreationMode(); else elseBlock">{{ 'CAREER_OBJECTIVE_CREATE.CREATE_TITLE' | translate }}</h1>
    <ng-template #elseBlock>
        <h1>{{ 'CAREER_OBJECTIVE_CREATE.EDIT_TITLE' | translate }}</h1>
    </ng-template>

    <form novalidate [formGroup]="creationForm">
        <ion-grid>
            <ion-row>
                <ion-col col-9>
                    <!-- Barre de statut -->
                    <ion-row>
                        <ion-col col-12>
                            <ion-badge color="{{careerObjective.careerObjectiveStatus.toLowerCase()}}" *ngIf="careerObjective.careerObjectiveStatus" float-right>
                                {{ 'GLOBAL.CAREER_OBJECTIVE_STATUS.'+careerObjective.careerObjectiveStatus | translate }}
                            </ion-badge>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col col-12>
                            <!-- Titre -->
                            <ion-item>
                                <ion-label floating class="required">{{ 'CAREER_OBJECTIVE_CREATE.FORM.TITLE' | translate }}</ion-label>
                                <ion-input type="text" [(ngModel)]="careerObjective.title" formControlName="titleControl"></ion-input>
                            </ion-item>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col col-12>
                            <!-- Contexte -->
                            <ion-item>
                                <ion-label floating>{{ 'CAREER_OBJECTIVE_CREATE.FORM.CONTEXT' | translate }}</ion-label>
                                <ion-textarea [(ngModel)]="careerObjective.context" formControlName="contextControl" name="context"></ion-textarea>
                            </ion-item>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col col-12>
                            <!-- Plan d'action -->
                            <ion-item>
                                <ion-label floating>{{ 'CAREER_OBJECTIVE_CREATE.FORM.ACTION_PLAN' | translate }}</ion-label>
                                <ion-textarea [(ngModel)]="careerObjective.actionPlan" formControlName="actionPlanControl" name="actionPlan"></ion-textarea>
                            </ion-item>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col col-6>
                            <!-- Commentaire cadre -->
                            <ion-item>
                                <ion-label floating>{{ 'CAREER_OBJECTIVE_CREATE.FORM.MANAGER_COMMENT' | translate }}</ion-label>
                                <ion-textarea [(ngModel)]="careerObjective.managerComment" formControlName="managerCommentControl" name="managerComment"></ion-textarea>
                            </ion-item>
                        </ion-col>
                        <ion-col col-6>
                            <!-- Commentaire PNC -->
                            <ion-item>
                                <ion-label floating>{{ 'CAREER_OBJECTIVE_CREATE.FORM.PNC_COMMENT' | translate }}</ion-label>
                                <ion-textarea [(ngModel)]="careerObjective.pncComment" formControlName="pncCommentControl" name="pncComment"></ion-textarea>
                            </ion-item>
                        </ion-col>
                    </ion-row>
                </ion-col>
                <!-- Bouton création point d'étape -->
                <ion-col col-3>
                    <h1>{{ 'CAREER_OBJECTIVE_CREATE.WAYPOINT_LIST_TITLE' | translate }}</h1>
                    <!--liste des point d'étape-->
                    <ion-content class="waypoint-list">
                        <button (click)="goToWaypointCreate()" class="add-waypoint clickable" *ngIf="careerObjective.careerObjectiveStatus === CareerObjectiveStatus.REGISTERED">
                            <ion-icon name="add"></ion-icon>
                        </button>
                        <ion-card class="clickable" *ngFor="let waypoint of waypointList" (click)="openWaypoint(waypoint.techId)">
                            <ion-card-content>
                                <span class="value">{{ waypoint.creationDate | date: 'dd/MM/yyyy'}}</span>
                                <h2>{{ waypoint.context }}</h2>
                            </ion-card-content>
                        </ion-card>
                    </ion-content>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col col-6>
                    <!-- Initiateur -->
                    <ion-label stacked class="required">{{ 'CAREER_OBJECTIVE_CREATE.FORM.INITIATOR' | translate }}</ion-label>
                    <ion-list radio-group [(ngModel)]="careerObjective.initiator" formControlName="initiatorControl">
                        <ion-item>
                            <ion-label>{{ 'GLOBAL.PNC_ROLE.MANAGER' | translate }}</ion-label>
                            <ion-radio value="MANAGER"></ion-radio>
                        </ion-item>

                        <ion-item>
                            <ion-label>{{ 'GLOBAL.PNC_ROLE.PNC' | translate }}</ion-label>
                            <ion-radio value="PNC"></ion-radio>
                        </ion-item>
                    </ion-list>
                </ion-col>
                <ion-col col-6>
                    <!-- Prochaine rencontre -->
                    <ion-label stacked>{{ 'CAREER_OBJECTIVE_CREATE.FORM.NEXT_ENCOUNTER_DATE' | translate }}</ion-label>
                    <ion-item>
                        <ion-label>
                            <ion-icon name="calendar"></ion-icon>
                        </ion-label>
                        <ion-datetime displayFormat="DD/MM/YYYY" [(ngModel)]="careerObjective.nextEncounterDate" formControlName="nextEncounterDateControl" [pickerOptions]="customDateTimeOptions" [doneText]="translateService.instant('GLOBAL.DATEPICKER.DONE')" [cancelText]="translateService.instant('GLOBAL.DATEPICKER.CANCEL')"></ion-datetime>
                    </ion-item>
                    <!-- Prioritaire -->
                    <ion-item>
                        <ion-label fixed>{{ 'CAREER_OBJECTIVE_CREATE.FORM.PRIORITIZED' | translate }}</ion-label>
                        <ion-checkbox [(ngModel)]="careerObjective.prioritized" formControlName="prioritizedControl"></ion-checkbox>
                    </ion-item>
                </ion-col>
            </ion-row>

            <!-- Barre de boutons -->
            <ion-row>
                <ion-col>
                    <!-- Bouton sauvegarder objectif en brouillon -->
                    <button ion-button color="primary" (click)="saveCareerObjectiveDraft()" [disabled]="creationForm.invalid" *ngIf="careerObjectiveStatusProvider.isTransitionOk(careerObjective.careerObjectiveStatus,CareerObjectiveStatus.DRAFT)">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.SAVE_DRAFT' | translate }}
                    </button>
                    <!-- Bouton supprimer objectif en brouillon -->
                    <button ion-button color="primary" (click)="confirmDeleteCareerObjectiveDraft()" [disabled]="deletionInProgress" *ngIf="careerObjective.careerObjectiveStatus === CareerObjectiveStatus.DRAFT">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.DELETE_DRAFT' | translate }}
                    </button>
                    <!-- Bouton sauvegarder objectif -->
                    <button ion-button color="primary-light" (click)="saveCareerObjectiveToRegisteredStatus()" [disabled]="creationForm.invalid" *ngIf="securityProvider.isManager() && careerObjectiveStatusProvider.isTransitionOk(careerObjective.careerObjectiveStatus,CareerObjectiveStatus.REGISTERED)">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.SAVE' | translate }}
                    </button>
                    <!-- Bouton valider objectif -->
                    <button ion-button color="primary" (click)="saveCareerObjectiveToValidatedStatus()" [disabled]="creationForm.invalid" *ngIf="securityProvider.isManager() && careerObjectiveStatusProvider.isTransitionOk(careerObjective.careerObjectiveStatus,CareerObjectiveStatus.VALIDATED)">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.VALIDATE' | translate }}
                    </button>
                    <!-- bouton abandonner objectif  -->
                    <button ion-button color="primary" (click)="saveCareerObjectiveToAbandonedStatus()" [disabled]="creationForm.invalid" *ngIf="securityProvider.isManager() && careerObjectiveStatusProvider.isTransitionOk(careerObjective.careerObjectiveStatus,CareerObjectiveStatus.ABANDONED)">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.ABANDON' | translate }}
                    </button>
                    <!-- bouton annuler statut validé d'un objectif  -->
                    <button ion-button color="primary" (click)="cancelCareerObjectiveValidation()" [disabled]="creationForm.invalid" *ngIf="securityProvider.isManager() && careerObjective.careerObjectiveStatus === CareerObjectiveStatus.VALIDATED">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.CANCEL_VALIDATION' | translate }}
                    </button>
                    <!-- bouton annuler statut abandonné d'un objectif  -->
                    <button ion-button color="primary" (click)="resumeAbandonedCareerObjective()" [disabled]="creationForm.invalid" *ngIf="securityProvider.isManager() && careerObjective.careerObjectiveStatus === CareerObjectiveStatus.ABANDONED">
                        {{ 'CAREER_OBJECTIVE_CREATE.BUTTONS.RESUME' | translate }}
                    </button>
                </ion-col>
            </ion-row>
        </ion-grid>
    </form>
</ion-content>
