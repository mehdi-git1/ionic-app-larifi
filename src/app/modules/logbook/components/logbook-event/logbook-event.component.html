<div *ngIf="editEvent">
    <form novalidate [formGroup]="logbookEventForm">
        <ion-grid>
            <ion-row class="event-date-and-checkbox-row">
                <ion-item class="event-date">
                    <ion-label class="required">{{ 'LOGBOOK.EDIT.EVENT_DATE' | translate }}</ion-label>
                    <ion-datetime [placeholder]="eventDateString" displayFormat="DD/MM/YYYY" pickerFormat="DD MMMM YYYY"
                        [(ngModel)]="logbookEvent.eventDate" formControlName="eventDate"
                        [doneText]="translateService.instant('GLOBAL.DATEPICKER.DONE')"
                        [cancelText]="translateService.instant('GLOBAL.DATEPICKER.CANCEL')" [monthNames]="monthsNames">
                    </ion-datetime>
                </ion-item>
                <ion-item class="event-checkbox" item-end>
                    <ion-label item-end>{{ 'LOGBOOK.EDIT.PNC_ORIGIN' | translate }}</ion-label>
                    <ion-checkbox item-end [(ngModel)]="logbookEvent.pncInitiator" [checked]="pncInitiator"
                        formControlName="pncInitiator">
                    </ion-checkbox>
                </ion-item>
                <ion-item class="event-checkbox" item-end>
                    <ion-label>{{ 'LOGBOOK.EDIT.IMPORTANT' | translate }}</ion-label>
                    <ion-checkbox item-end [(ngModel)]="logbookEvent.important" [checked]="important"
                        formControlName="important">
                    </ion-checkbox>
                </ion-item>
            </ion-row>
            <ion-row>
                <ion-col>
                    <ion-item class="category">
                        <ion-label class="required" floating>{{ 'LOGBOOK.EDIT.CATEGORY' | translate }}</ion-label>
                        <ion-select interface="popover" [compareWith]="compareCategories"
                            [(ngModel)]="logbookEvent.category" formControlName="category">
                            <ion-option *ngFor="let category of logbookEventCategories" [value]="category">
                                {{category?.label}}</ion-option>
                        </ion-select>
                    </ion-item>
                </ion-col>
            </ion-row>
            <ion-row class="title-row">
                <ion-col col-12>
                    <ion-item>
                        <ion-label class="required" floating>{{ 'LOGBOOK.EDIT.EVENT_TITLE' | translate }}</ion-label>
                        <ion-input #eventTitle type="text" class="event-title" [(ngModel)]="logbookEvent.title"
                            formControlName="title" autocorrect="on" [maxlength]="titleMaxLength"></ion-input>
                    </ion-item>
                    <span class="event-length">{{eventTitle.value.length}}/{{titleMaxLength}}</span>
                </ion-col>
            </ion-row>
            <ion-row class="description-row">
                <ion-col col-12>
                    <ion-label class="required" floating>{{ 'LOGBOOK.EDIT.EVENT_DESCRIPTION' | translate }}</ion-label>
                    <text-editor name="eventContent" [mode]="TextEditorModeEnum.FULL"
                        [ngModelOptions]="{standalone: true}" [(ngModel)]="logbookEvent.content"
                        [parentForm]="logbookEventForm" [controlForm]="'content'"
                        [placeholder]="'LOGBOOK.EDIT.EVENT_DESCRIPTION' | translate" formControlName="content">
                    </text-editor>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col col-12>
                    <document-manager [documents]="logbookEvent.attachmentFiles" [readonly]="false">
                    </document-manager>
                </ion-col>
            </ion-row>
            <ion-row class="notification-row">
                <ion-col class="persons-to-notify">
                    <ion-label>{{ 'LOGBOOK.EDIT.PERSONS_TO_NOTIFY' | translate }} :</ion-label>
                    <ion-item class="event-checkbox">
                        <ion-label>
                            <span [ngClass]="{'no-value' : !pnc.pncInstructor }">{{ pnc.pncInstructor?.lastName }}
                                {{ pnc.pncInstructor?.firstName | titlecase}} </span> ({{ 'PNC_IDENTITY.REFERENT_INSTRUCTOR'
                        | translate }})</ion-label>

                        <ion-checkbox [disabled]="!pnc.pncInstructor"
                            (ionChange)="updatePncNotifiedList($event, pnc.pncInstructor)"
                            [checked]="isPncNotified(pnc.pncInstructor)"></ion-checkbox>
                    </ion-item>
                    <ion-item class="event-checkbox">
                        <ion-label>
                            <span [ngClass]="{'no-value' : !pnc.pncRds }">{{ pnc.pncRds?.lastName}}
                                {{ pnc.pncRds?.firstName | titlecase}} </span> ({{ 'PNC_IDENTITY.RDS' |
                        translate }})</ion-label>
                        <ion-checkbox [disabled]="!pnc.pncRds" (ionChange)="updatePncNotifiedList($event, pnc.pncRds)"
                            [checked]="isPncNotified(pnc.pncRds)"></ion-checkbox>
                    </ion-item>
                </ion-col>
                <ion-col class="other-contacts">
                </ion-col>
            </ion-row>
        </ion-grid>
        <!-- Barre de boutons -->
        <div class="button-bar-right button-bar">
            <!-- Bouton Annuler -->
            <button ion-button color="primary" outline (click)="cancelLogbookEventCreationOrEdition()">
                {{ 'LOGBOOK.BUTTONS.CANCEL' | translate }}
            </button>
            <!-- Bouton enregistrer -->
            <button ion-button
                *ngIf="mode === LogbookEventModeEnum.CREATION || mode === LogbookEventModeEnum.LINKED_EVENT_CREATION"
                color="primary" (click)="confirmSaveLogbookEvent()" [disabled]="logbookEventForm.invalid">
                {{ 'LOGBOOK.BUTTONS.SAVE' | translate }}
            </button>
            <!-- Bouton mettre Ã  jour-->
            <button ion-button #updateEvent *ngIf="mode === LogbookEventModeEnum.EDITION" color="primary"
                (click)="confirmUpdateLogbookEvent()" [disabled]="logbookEventForm.invalid">
                {{ 'LOGBOOK.BUTTONS.UPDATE' | translate }}
            </button>
        </div>
    </form>
</div>