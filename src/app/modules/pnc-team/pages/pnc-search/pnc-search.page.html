<ion-header>
    <ion-toolbar>
        <page-header (refreshPage)="initPage()" [showRefreshIcon]="true">
            <span slot="start">
                <ion-fab-button (click)="toggleFiltersMenu()" size="small" color="primarydark">
                    <span class="edospnc-filter-sharp"></span>
                </ion-fab-button>

                {{ 'PNC_SEARCH.CRITERIA.FILTER' | translate }} ({{enabledFiltersCount}})
            </span>
            <ng-container slot="center">
                <ng-container *ngIf="isAlternantSearch(); else alternantSearchTitle">
                    {{ 'GLOBAL.ALTERNANT_TEAM' | translate }}</ng-container>
                <ng-template #alternantSearchTitle>{{ 'GLOBAL.PNC_TEAM' | translate }}</ng-template>
            </ng-container>
        </page-header>
    </ion-toolbar>
    <pnc-edossier-header [activeTab]="TabHeaderEnum.ALTERNANT_SEARCH"></pnc-edossier-header>

    <div class="filter-bar-container">
        <div class="filter-bar">
            <ion-label>{{ 'PNC_SEARCH.CRITERIA.SORT.LABEL'| translate }}</ion-label>
            <ion-select interface="popover" [value]="filters.sortColumn" (ionChange)="sortByColumn($event.detail.value)">
                <ion-select-option value="lastName">
                    {{ 'PNC_SEARCH.CRITERIA.SORT.LAST_NAME'  | translate }}
                </ion-select-option>
                <ion-select-option value="lastEObservationDate">
                    {{ 'PNC_SEARCH.CRITERIA.SORT.LAST_EOBSERVATION'  | translate }}
                </ion-select-option>
                <ion-select-option value="lastProfessionalInterviewDate">
                    {{ 'PNC_SEARCH.CRITERIA.SORT.LAST_PROFESSIONAL_INTERVIEW'  | translate }}
                </ion-select-option>
                <ion-select-option value="lastCareerObjectiveUpdateDate">
                    {{ 'PNC_SEARCH.CRITERIA.SORT.LAST_UPDATED_CAREER_OBJECTIVE'  | translate }}
                </ion-select-option>
            </ion-select>

            <div class="filter-order">
                <mat-button-toggle-group name="sortDirections" #sortDirectionToggleGroup [value]="filters.sortDirection" (click)="sortColumnBySelectedDirection()">
                    <mat-button-toggle disableRipple="true" value="ASC">
                        <ion-icon slot="icon-only" name="arrow-up"></ion-icon>
                    </mat-button-toggle>
                    <mat-button-toggle disableRipple="true" value="DESC">
                        <ion-icon slot="icon-only" name="arrow-down"></ion-icon>
                    </mat-button-toggle>
                </mat-button-toggle-group>
            </div>

        </div>
    </div>
</ion-header>

<ion-content forceOverscroll="true" scroll-y="false">
    <mat-sidenav-container>
        <mat-sidenav [(opened)]="isMenuOpened" [autoFocus]="false">
            <pnc-search-filter [filters]="filters" [searchMode]="searchMode" (filtersChanged)="launchSearch()" (pncSelected)="openPncHomePage($event)" (enabledFiltersCountChanged)="setEnabledFiltersCount($event)"></pnc-search-filter>
        </mat-sidenav>
        <mat-sidenav-content infiniteScroll [scrollWindow]="false" [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50" [infiniteScrollDisabled]="isLoading" (scrolled)="loadNextPage()">
            <div class="page-container">
                <div class="filtered-pnc-list-container">
                    <edossier-spinner *ngIf="isLoading; else pageBlock"></edossier-spinner>
                    <ng-template #pageBlock>
                        <div *ngIf="hasPncs(); else noDataBlock">
                            <pnc-card *ngFor="let pnc of filteredPncs" [itemMember]="pnc" (click)="openPncHomePage(pnc)">
                            </pnc-card>
                        </div>
                        <ng-template #noDataBlock>
                            <div class="no-data-splash">
                                <ion-icon name="contacts"></ion-icon>
                                <span>{{ 'PNC_SEARCH.NO_PNC_FOUND' | translate }}</span>
                            </div>
                        </ng-template>
                    </ng-template>
                </div>
            </div>
        </mat-sidenav-content>
    </mat-sidenav-container>
</ion-content>
